"use strict";var fetch=require("node-fetch"),router=require("express").Router();router.get("",function(e,r){r.render("pages/index")}),router.get("/about",function(e,r){r.render("pages/about")}),router.get("/login",function(e,r){var t=e.query.mapId;r.render("pages/login",{mapId:t})}),router.get("/map",function(e,r){var t=e.cookies.user,n=e.query.mapId;t?r.render("pages/map",{mapId:n}):r.redirect("/login?mapId=".concat(n))}),router.get("/maps",function(e,r){try{e.cookies.user;r.render("pages/maps")}catch(e){r.redirect("/")}}),router.get("/contracts",function(e,r){var t,n,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t="http://ouri-digital-agent.cf/ibc/app/אורי",t=encodeURI(t),e.next=5,regeneratorRuntime.awrap(fetch(t));case 5:return n=e.sent,e.next=8,regeneratorRuntime.awrap(n.json());case 8:o=e.sent,r.render("pages/contracts",{contracts:o}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0),r.redirect("/");case 16:case"end":return e.stop()}},null,null,[[0,12]])}),router.get("/statements",function(e,r){try{e.cookies.user;var t=e.query.contractId;if(!t)throw new Error("No contract Id in query");r.render("pages/statements",{contractId:t})}catch(e){console.error(e),r.redirect("/")}}),module.exports=router;